
1、小程序的已签到数量跟签到点数量不匹配，现在实际显示的是已答题数量；（签到界定，只要在签到点答题了，不管对错，都算签到过了）
原因：历史版本没有附加答题时候ok  由于后来版本增加附加答题，并且记录作为签到点答题记录上报到数据库导致
处理：对相同签到点统计数据进行签到点相同，答题不同的数据进行逻辑去重后作为计算结果，涉及 线路详情页展示和 进入详情页展示的两个接口
done 已处理。2  排查逻辑和复现2  开发1 测试1   

2、地图上的点标，最后一个完成的签到点不会变黄，应该是签到完所有的都变黄；
原因： 打卡到最后一个点，用户打卡了，识别到会变成打卡颜色，又因为是当前点，又变成了当前点颜色。先后逻辑顺序。
处理： 当前点如果是已打卡，就用已打卡颜色，不再使用当前点颜色，未打卡时使用当前点颜色。
done bug  0   排查逻辑和复现2

3、时间大于100小时后，如果超过了后台设定的时间，显示“已超时！”，现在是无论是否超时都显示99:59:59

done 历史需求，已处理 0

4、之前曾经有过的一个功能，不知道什么时候好像失效了。如果已签到答题成功或已签到机会用光，应该提示 '您已经在这里签到过，请前往下一个签到点吧！'
ignore 处理： 目前看页面上是还有这个功能提示的，网络快的时候或者页面改动会导致这个提示不显示，现在看是签到后会有对应的提示结果。基本不影响使用。

5、支付上报排查
原因： 多次排查并不能确定实际未上报原因，之前也有过，商家概率千或万分之几，从微信侧看是在一定版本内支持。解决方案：对接支付结果异步补救
done 已处理。3 对接微信支付后异步支付结果通知接口，简单处理只标记 支付金额、支付用户id ，无线路等其他逻辑。


6、支付中文乱码
done 已处理 0 api 版本兼容编码问题， 


待处理内容： 
1、 4.13号后的上线 用户信息获取微信接口升级，
为优化用户的使用体验，平台将进行以下调整：
2021年2月23日起，通过wx.login接口获取的登录凭证可直接换取unionID
2021年4月13日后发布新版本的小程序，无法通过wx.getUserInfo与<button open-type="getUserInfo"/>获取用户个人信息（头像、昵称、性别与地区），将直接获取匿名数据（包括userInfo与encryptedData中的用户个人信息），获取加密后的openID与unionID数据的能力不做调整。
新增getUserProfile接口（基础库2.10.4版本开始支持），可获取用户头像、昵称、性别及地区信息，开发者每次通过该接口获取用户个人信息均需用户确认。具体接口文档：《getUserProfile接口文档》
pre 处理： 预计 4.18 -4.25 有上线进行验证 处理

2、4.28号前 服务器域名 https 免费证书1年到期 申请重新部署。
pre 处理： 预计 4.18 -4.25 有上线进行验证 处理

3、
3.1第二个是：在线路首页下面加一个“当天积分排名”、“近7天积分排名”

pre： 当前已有 总积分和单个线路签到的积分明细。
需要根据线路、时间、用户维度计算积分进行分组统计排序接口方法 3
（不写数据库，动态计算接口，如果需要保留数据库加2）
前端接收处理函数&页面数据简单出不处理样式 1
预计 4-6 小时

3.2、第三个变成在detailon页面，显示谁谁谁在什么时间签到了几号点，显示最近的十条或者是30条记录这种。
pre:  当前数据已经在数据库有，提供后端接口1 前端接收处理函数&页面数据简单出不处理样式 1 
预计 2小时



支付
=============2020.12.22=========

前提，申请开通微信支付 

开发
微信接口对接：
调用微信接口涉及处理的点
1算法签名 4-6小时
2成功处理逻辑 2-3小时
3失败处理逻辑 1小时 

后台:
4数据库增加线路和用户，用户支付信息数据库表，2小时
5提供插入支付信息接口 2小时
6提供查询信息接口 1小时

小程序页面:
7对线路进入进行接口验证和提示逻辑处理。2~3小时    ------------去掉，细化逻辑时间下面

微信接口调试测试，后台配置 预留2-4小时 

总共大约  16~22 小时 

更新  14-19

一个小程序，第二个重复开发代码抑制配置等预计一个要半天左右时间

=====================2021-01-16==============
更新需求
收费拆分 按照时间收费、按照线路收费：

1、按照时间收费
1.1、后台新增管理页面，时间、费用 管理涉及
1.1.1、后台管理页面功能：数据库新增两个字段，管理页面提供修改功能、展示数据功能两个接口。 3
1.1.2、提供查询接口，为小程序端页面和用户接口做逻辑判断使用 1
1.1.3、用户表新增字段，用于标记用户收费的有效期到哪天，修改与查询接口 2


2、线路收费
2.1、在线路上设置 几个点免费，新增字段，后台展示和修改功能，提供接口给前端小程序。2
2.2、统计用户在当前线路已经玩几个点后端接口，提供给小程序前端多出调用逻辑。1 
2.3、小程序页面做逻辑处理判断，线路是否收费、免费点数，用户已玩几个点逻辑处理。2

更新  14-19  + 11  大约 25-32


设置API密钥 ： bcc534f8f4c5967cf55844b7c0c1eae1
openid: oHq_k5La6tz61XQFaPq2jwiHYdMI
http://localhost:8080/qihntest//wx/wxPay?openid=oHq_k5La6tz61XQFaPq2jwiHYdMI&money=1&pname=7%E5%A4%A9%E4%BC%9A%E5%91%98
0256 9965011  茅台镇 60年老窖  孙 

wxPay res  {"timeStamp":"1611408905","package":"prepay_id=wx23213505635210c35064cea19630000000","out_trade_no":"20210123213505008588","money":"1","paySign":"BA6D36D9B860DBB497BF81020013E378","appid":"wxb396476de17508d4","signType":"MD5","nonceStr":"drq5w7qi2pcgzseec8eilmxdryty1a8x"}
detail.js:47 pay-success res  {"errMsg":"requestPayment:ok"}
detail.js:59 payresup res  {"money":"1","endtime":"2024-01-23","ok":"ok"}
